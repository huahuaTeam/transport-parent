<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<link href="/hm/JQuery-EasyUI-1.5/themes/insdep/easyui.css" rel="stylesheet">

<link href="/hm/js/JQuery-EasyUI-1.5/plugin/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">

<link href="/hm/js/JQuery-EasyUI-1.5/themes/insdep/easyui_animation.css"
      rel="stylesheet">
<link href="/hm/js/JQuery-EasyUI-1.5/themes/insdep/insdep_theme_default.css"
      rel="stylesheet">
<link href="/hm/js/JQuery-EasyUI-1.5/themes/insdep/easyui_plus.css" rel="stylesheet">

<link href="/hm/JQuery-EasyUI-1.5/themes/insdep/iconfont/iconfont.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="/js/jquery-1.8.3.min.js"></script>
<link rel="stylesheet" type="text/css" href="/hm/zTree_v3/css/zTreeStyle/zTreeStyle.css">
<script type="text/javascript" src="/hm/zTree_v3/js/jquery.ztree.all.min.js"></script>
<style>

    a {
        color: red;
        text-decoration: none;
    }

    a:hover {
        color: blue;
        cursor: pointer;
    }

</style>

<body>
<div style="margin:20px 0;">
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="collapseAll()">关闭</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="expandAll()">展开</a>
</div>
<table id="tg" class="easyui-treegrid" title="货物摆放" style="width: 100%;height: 500px;"
       data-options="
				rownumbers: true,
				animate: true,
				collapsible: true,
				fitColumns: true,
				url: 'getPlaceGood.do',
				method: 'get',
				idField: 'id',
				treeField: 'name'
			">
    <thead>
    <tr>
        <th data-options="field:'name',width:180">货物名称/入库编号</th>
        <th data-options="field:'reptype',width:60,align:'right'">货物类型</th>
        <th data-options="field:'repcount',width:80">货物数量</th>
        <th data-options="field:'status',width:80">状态</th>
        <th data-options="field:'cz',width:80">操作</th>
    </tr>
    </thead>
</table>

<div id="Model" class="easyui-window" title="货物摆放" data-options="modal:true,closed:true"
           style="width:350px;height:450px;padding:10px;">
    <div id="ztreeDiv">
        <ul id="ztree" class="ztree" style="width: 80px;height: auto;padding:auto; ">
        </ul>
    </div>
    <button onclick="onCheck()" class="easyui-linkbutton button-teal l-btn l-btn-small" style="margin-left: 250px;margin-top: 20px">get</button>
</div>
<script type="text/javascript" src="/hm/JQuery-EasyUI-1.5/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/hm/JQuery-EasyUI-1.5/themes/insdep/jquery.insdep-extend.min.js"></script>
<script type="text/javascript">

    var zTreeObj;

    // 过滤函数
    function filter(treeId, parentNode, childNodes) {
        if (!childNodes)
            return null;
        for (var i = 0, l = childNodes.length; i < l; i++) {
            childNodes[i].name = childNodes[i].name.replace(/\.n/g, '.');
        }
        return childNodes;
    }

    //
    var setting = {
        async: {
            enable: true,
            dataType: "json",
            type: "get",
            url: "loadRepBai.do",
        },
        data: {
            key: {
                name: "name"
            },
            simpleData: {
                enable: true,
                idKey: "id",
                pIdKey: "pid",
                sonSign: true
            }
        }, check: {
            enable: true,
            chkStyle: 'checkbox',
            //chkboxType树形  Y表示选中该checkbox  N表示取消选中checkBOX
            //ps P表示父节点 也就是你选中子节点之后  父节点也被选中
            //s表示子节点  表示你选中当前节点之后 其子节点也都被选中
            chkboxType: {
                "Y": "ps",
                "N": "ps"
            }
        }
    }
    zTreeObj = $.fn.zTree.init($("#ztree"), setting);


    function onCheck(e, treeId, treeNode) {
        var treeObj = $.fn.zTree.getZTreeObj("ztree"), nodes = treeObj.getCheckedNodes(true), v = "";
        var str="";
        for (var i = 0; i < nodes.length; i++) {
            str+=nodes[i].id+",";
        }
        var arrs = str.split(",");
        console.log(arrs[2]);
        $.ajax({
            url:"PutinStorage.do",
            type:"post",
            data:{"id":arrs[2]},
            success:function(data){
                location.reload();
                //$('#Model').modal('closed');
            }
        });
    }

</script>

<script type="text/javascript">
    function collapseAll() {
        $('#tg').treegrid('collapseAll');
    }

    function expandAll() {
        $('#tg').treegrid('expandAll');
    }

    function expandTo() {
        $('#tg').treegrid('expandTo', 21).treegrid('select', 21);
    }

    function openDiv(obj) {
        $.post("savelistId.do",{"listId":obj});
        $('#Model').window('open');
    }

</script>
</body>
</html>